import{O as c,R as o,U as p,V as a,Vb as l,W as h,Wb as k,u as n}from"./chunk-22QBDJS3.js";var u=new p("api_url");var i=class s{accessTokenKey="accessToken";setAccessToken(e){localStorage.setItem(this.accessTokenKey,e)}getAccessToken(){return localStorage.getItem(this.accessTokenKey)}clearAccessToken(){localStorage.removeItem(this.accessTokenKey)}static \u0275fac=function(t){return new(t||s)};static \u0275prov=o({token:s,factory:s.\u0275fac,providedIn:"root"})};var m=class s{constructor(e,t){this.http=e;this.tokenService=t}baseURL=h(u);currentUser=null;login(e){return this.http.post(`${this.baseURL}Auth/login`,e,{withCredentials:!0}).pipe(c(t=>{let r=t.data?.accessToken||t.accessToken;if(r)this.tokenService.setAccessToken(r);else throw new Error("Access token not found in login response")}),n(t=>t))}signup(e){return this.http.post(`${this.baseURL}Auth/register`,e,{withCredentials:!0}).pipe(c(t=>{let r=t.data?.accessToken||t.accessToken;if(r)this.tokenService.setAccessToken(r);else throw new Error("Access token not found in signup response")}),n(t=>t))}refreshToken(){return this.http.post(`${this.baseURL}Auth/refresh`,{},{withCredentials:!0}).pipe(n(e=>{let t=e.data?.accessToken||e.accessToken;if(!t)throw new Error("Access token not found in refresh response");return this.tokenService.setAccessToken(t),{accessToken:t}}))}saveNewTokens(e){e?.accessToken?localStorage.setItem("accessToken",e.accessToken):console.error("Access token is missing")}getAccessToken(){return this.tokenService.getAccessToken()}removeAccessToken(){this.tokenService.clearAccessToken()}logout(){return this.http.post(`${this.baseURL}Auth/logout`,{},{withCredentials:!0})}forgetPassword(e){return this.http.post(`${this.baseURL}Auth/forget-password`,e,{withCredentials:!0,responseType:"text"})}submitNewPassword(e){return this.http.post(`${this.baseURL}Auth/reset-password`,e,{withCredentials:!0,responseType:"text"})}confirmPasswordChange(e,t){let r=new l().set("token",e).set("action",t);return this.http.get(`${this.baseURL}Auth/confirm-password-change`,{params:r,withCredentials:!0})}static \u0275fac=function(t){return new(t||s)(a(k),a(i))};static \u0275prov=o({token:s,factory:s.\u0275fac,providedIn:"root"})};export{u as a,i as b,m as c};
